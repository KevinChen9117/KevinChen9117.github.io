---
title: "Win32::Screenshot"
date: 2005-10-14 00:40:15 +0000
orig_url: http://advogato.org/person/pjf/diary/437.html
---
<p><b>Win32::Screenshot</b><br />
I've just discovered <a href="http://search.cpan.org/~psme/Win32-Screenshot-1.20/Screenshot.pm">Win32::Screenshot</a>, a Perl module that not only allows one to capture the entire screen, but more importantly makes it easy to capture individual windows, or portions of windows.
<p>
Installation of the module was a bit of a pain.  Even though there is a ppd file at <a href="http://theoryx5.uwinnipeg.ca/ppms/Win32-Screenshot.ppd">http://theoryx5.uwinnipeg.ca/ppms/Win32-Screenshot.ppd</a> it depends upon <i>PerlMagick</i>, which under more recent releases is properly named <i>Image::Magick</i> and can be selected as part of the windows <a href="http://www.imagemagick.org/script/binary-releases.php#windows">ImageMagick installer</a>.  I quickly hacked together my own <a href="http://perltraining.com.au/~pjf/Win32-Screenshot.ppd">ppd file</a> that simply omits the dependency section.  Besides from that, the whole thing worked like a charm.
<p>
So why is <tt>Win32::Screenshot</tt> so useful?  Well, a lot of Windows programs have no command-line interface.  If you want to communicate with them, you have no choice but to use the GUI.  That's fine for humans, but what if you want to perform automated testing, or automatically watch a window for a particular event?  Then <tt>Win32::Screenshot</tt>, especially in conjunction with <a href="http://search.cpan.org/~ctrondlp/Win32-GuiTest-1.50.3-ad/guitest.pm">Win32::GuiTest</a>, really shines.  
<p>
I've been joking with my friends that I'm going to use all this to play <a href="http://www.puzzlepirates.com/">Puzzle Pirates</a> automatically.  In reality I have a much more interesting (but unfortunately secret) project at hand.
