---
title: "The most frustrating work"
date: 2005-07-06 23:02:23 +0000
orig_url: http://advogato.org/person/pjf/diary/412.html
---
<p><b>The most frustrating work</b><br/>
Running a small business exposes one to a wide range of hurdles.  Work can range from the very good (presenting at conferences/user groups) to the downright awful (being recalled from holidays to fix critically dead machines at 2am).  The main compenstation is that the bad work tends to pay extremely well.
<p>
Throw into that a whole lot of conflict resolution, government regulation, taxation requirements, travel, and plenty of human interaction, and you have a pretty good range of learning experiences.  Some people hate their jobs, but I love mine.  I just hate certain particular aspects of it.
<p>
Recently, one of our office desktops started developing bad sectors on the hard-drive.  This isn't a big deal, all the important data is stored on a central server with RAID and tape backups.  We also have a drawer full of hard-drives (somehow we keep winning these, or getting them back under warrantee), so replacing the failing drive should be easy, right?
<p>
Well, for Linux it is.  Fire up <a href="http://www.knoppix.org/">Knoppix</a>, and use <a href="http://www.gnu.org/software/parted/">parted</a> to copy the old partitions across.  A little bit of magic with your choice of bootloader, and you have a transferred Linux system onto a fresh, new, bigger hard-drive.
<p>
If you've got bad sectors involved, then parted may not be able to do the deeds, as it tries a block-for-block copy.  However for an ext2/ext3 filesystem, you can simply partition, make a new filesystem (mke2fs), and use one of the hundreds of different ways of copying an ext2 filesystem, in my case <tt>cd /path/to/new/filesystem; dump -0 /dev/hdXX | restore -r</tt>.  Easy
<p>
Now comes the most frustrating part of all.  This machine also occasionally runs Windows 2000.  We don't actually use Windows for anything except for games, but I'm very fond of my games, and unfortunately there are still a couple that only run under Windows.  Unfortunately, transferring Windows across was not quite as easy.
<p>
Parted would happily copy and extend the partition, great!  However upon trying to boot Windows, I get a whole lot of nothing.  After going round-and-round with recovery consoles and boot records, it still won't boot.  Hmmm...
<p>
I decide to see if I can get a fresh install of Windows to boot.  If that fails, I know my other attempts are hopeless.  If it succeeds, then I know as a worst-case I can simply re-install Windows and the games.
<p>
The fresh install, onto a freshly partitioned hard-drive, fails.  It chugs along quite happily until it needs its first reboot, and then then issues the dreaded words <tt>"Error Loading Operating System"</tt>.
<p>
A quick search reveals a <a href="http://support.microsoft.com/?kbid=326676&sd=RMVP">fix from Microsoft</a> for the problem.  Upgrade your machine's BIOS &mdash;  not <i>quite</i> what I had in mind.  Given that Google reveals about <a href="http://www.google.com/search?q=%22Error+Loading+Operating+System%22">11,000</a> other pages which contain this exact phrase, and given most seem to recommend fiddling the disk geometery from CHS to LBA, I'm not going to try and flash a working BIOS just yet.
<p>
It looks like the problem is fundamentally with windows installing onto large partitions on big drives.  This isn't unique to windows, due to some real legacy reasons most machines have troubles booting something that isn't close to the start of the disk.  It's also been solved in a variety of ways, including itty-bitty boot partitions for Linux, and intermediate stages for <a href="http://www.gnu.org/software/grub/">grub</a>.  Those systems also give much more precise errors when something goes wrong.
<p>
So, for this machine I know the master boot record is fine, and because the Windows partition is right at the start of the disk, I know that its boot-sector can be reached, but things go wrong from there.  Perhaps I can start with an installation onto a small partition, and then try growing things from there.  Clearly I have an exciting time in repartitioning and re-installing ahead of me.
<p>
The ironic thing is isn't my workstation, and Windows is completely unrequired for our business.  Fundamentally its costing only $0.50/day in opportunity costs in not being able to play a MMROPG, yet it's the most frustrating issue that I've encountered in the last month.  Damn my strong beliefs that if you have a computer you should be using it to provide the maximum entertainment value.
<p>
On reflection, if I consider <i>this</i> to be my most troublesome problem, then I really don't have that much to complain about, do I?
